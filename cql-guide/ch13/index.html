<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.65">
<title data-react-helmet="true">Chapter 13: JSON Output | CG/SQL</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Chapter 13: JSON Output | CG/SQL"><meta data-react-helmet="true" name="description" content="&lt;!---"><meta data-react-helmet="true" property="og:description" content="&lt;!---"><meta data-react-helmet="true" property="og:url" content="https://cgsql.dev/cql-guide/ch13"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://cgsql.dev/cql-guide/ch13"><link rel="stylesheet" href="/styles.45b22519.css">
<link rel="preload" href="/styles.480d1f30.js" as="script">
<link rel="preload" href="/runtime~main.34082030.js" as="script">
<link rel="preload" href="/main.b815b31d.js" as="script">
<link rel="preload" href="/1.2e95473d.js" as="script">
<link rel="preload" href="/2.0c45b020.js" as="script">
<link rel="preload" href="/3.d04889a6.js" as="script">
<link rel="preload" href="/1be78505.d00e88e1.js" as="script">
<link rel="preload" href="/82.ac17f5fe.js" as="script">
<link rel="preload" href="/5456faf3.a2899e62.js" as="script">
<link rel="preload" href="/17896441.ea9e5e3f.js" as="script">
<link rel="preload" href="/c161a506.5d6875a9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><strong class="navbar__title">CG/SQL</strong></a><a class="navbar__item navbar__link" href="/docs/introduction">Docs</a><a class="navbar__item navbar__link" href="/cql-guide/ch01">CQL Guide</a><a class="navbar__item navbar__link" href="/program-diagram">Railroad Diagram</a><a class="navbar__item navbar__link" href="/json-diagram">Railroad Diagram: JSON</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebookincubator/CG-SQL" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><strong class="navbar__title">CG/SQL</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/introduction">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/cql-guide/ch01">CQL Guide</a></li><li class="menu__list-item"><a class="menu__link" href="/program-diagram">Railroad Diagram</a></li><li class="menu__list-item"><a class="menu__link" href="/json-diagram">Railroad Diagram: JSON</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/facebookincubator/CG-SQL" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">CQL Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cql-guide/ch01">Chapter 1: Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cql-guide/ch02">Chapter 2: Using Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cql-guide/ch03">Chapter 3: Expressions, Literals, Nullability, Sensitivity</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cql-guide/ch04">Chapter 4: Procedures, Functions, and Control Flow</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cql-guide/ch05">Chapter 5: Types of Cursors, OUT and OUT UNION, and FETCH flavors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cql-guide/ch06">Chapter 6: Calling Procedures Defined Elsewhere</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cql-guide/ch07">Chapter 7: CQL Result Sets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cql-guide/ch08">Chapter 8: Functions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cql-guide/ch09">Chapter 9: Statements Summary and Error Checking</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cql-guide/ch10">Chapter 10: Schema Management Features</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cql-guide/ch11">Chapter 11: Previous Schema Validation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cql-guide/ch12">Chapter 12: Testability Features</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/cql-guide/ch13">Chapter 13: JSON Output</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cql-guide/ch14">Chapter 14: CQL Query Fragments</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Appendix</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cql-guide/x1">Appendix 1: Command Line Options</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cql-guide/x2">Appendix 2: CQL Grammar</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cql-guide/x3">Appendix 3: Control Directives</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cql-guide/x4">Appendix 4: CQL Error Codes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cql-guide/x5">Appendix 5: JSON Schema Grammar</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cql-guide/x6">Appendix 6: CQL In 20 Minutes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cql-guide/x7">Appendix 7: CQL Anti-patterns</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cql-guide/x8">Appendix 8: CQL Best Practices</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Chapter 13: JSON Output</h1></header><div class="markdown"><p>To help facilitate additional tools that might want to depend on CQL input files further down the toolchain CQL includes a JSON output format for SQL DDL as well as stored procedure information, including special information for a single-statement DML.  &quot;Single-statement DML&quot; refers to those stored procedures that that consist of a single <code>insert</code>, <code>select</code>, <code>update</code>, or <code>delete</code>.   Even though such procedures are just one statement, good argument binding can create very powerful DML fragments that are re-usable.  Many CQL stored procedures are of this form (in practice maybe 95% are just one statement).</p><p>Below are some examples of the JSON output taken from a CQL test file.  Note that the JSON has free text inserted into it as part of the test output, that obviously doesn&#x27;t appear in the final output but it is especially illustrative here.  This example illustrates almost all the possible JSON fragments.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;tables&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>Each table appears fully formed in its own JSON hunk as below.  <code>isAdded</code> and <code>isDeleted</code> correspond to the presence of an <code>@create</code> or <code>@delete</code> annotation respectively.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE TABLE Foo(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      id INTEGER NOT NULL,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      name TEXT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;Foo&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;temp&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;ifNotExists&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;withoutRowid&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;isAdded&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;isDeleted&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;columns&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isAdded&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isDeleted&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isPrimaryKey&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isUniqueKey&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isAutoIncrement&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;name&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;text&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isAdded&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isDeleted&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isPrimaryKey&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isUniqueKey&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isAutoIncrement&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;primaryKey&quot; : [  ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;foreignKeys&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;uniqueKeys&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;indices&quot; : [ &quot;region_0_index&quot;, &quot;MyIndex&quot;, &quot;MyOtherIndex&quot; ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>Here we introduce a primary key and its JSON.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE TABLE T2(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      id INTEGER PRIMARY KEY</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;T2&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;temp&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;ifNotExists&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;withoutRowid&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;isAdded&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;isDeleted&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;columns&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;primaryKey&quot; : [ &quot;id&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>General purpose column information is also present.  Again a fragment for brevity.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE TABLE T3(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      id INTEGER UNIQUE AUTOINCREMENT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;T3&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;columns&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isAdded&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isDeleted&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isPrimaryKey&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isUniqueKey&quot; : 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isAutoIncrement&quot; : 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>Columns and tables can have flexible attributes which are used downstream.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @ATTRIBUTE(foo=bar)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE TABLE T4(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      @ATTRIBUTE(cool)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      id INTEGER</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;T4&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;columns&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;attributes&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              &quot;name&quot; : &quot;cool&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              &quot;value&quot; : 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;attributes&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;foo&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;value&quot; : &quot;bar&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>Here&#x27;s an example with revision marks</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE TABLE T8(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      id INTEGER</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ) @CREATE(1) @DELETE(3)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;T8&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;temp&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;ifNotExists&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;withoutRowid&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;isAdded&quot; : 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;isDeleted&quot; : 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;columns&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>The usual constraints are also recorded.   This example has a unqiue key on a column and foreign keys.  Note that the unique key is reported the same as if it had been declared in a standalone fashion.  There is a lot of stuff in this table...</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE TABLE T10(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      id1 INTEGER UNIQUE,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      id2 INTEGER,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      id3 INTEGER,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      id4 INTEGER UNIQUE,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      PRIMARY KEY (id1, id2),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      FOREIGN KEY (id1, id2) REFERENCES T9 (id2, id1),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      CONSTRAINT uk1 UNIQUE (id2, id3),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      CONSTRAINT uk2 UNIQUE (id3, id4)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;T10&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;columns&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id1&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isAdded&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isDeleted&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isPrimaryKey&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isUniqueKey&quot; : 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isAutoIncrement&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id2&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isAdded&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isDeleted&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isPrimaryKey&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isUniqueKey&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isAutoIncrement&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id3&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isAdded&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isDeleted&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isPrimaryKey&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isUniqueKey&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isAutoIncrement&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id4&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isAdded&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isDeleted&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isPrimaryKey&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isUniqueKey&quot; : 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isAutoIncrement&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;primaryKey&quot; : [ &quot;id1&quot;, &quot;id2&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;foreignKeys&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;columns&quot; : [ &quot;id1&quot;, &quot;id2&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;referenceTable&quot; : &quot;T9&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;referenceColumns&quot; : [ &quot;id2&quot;, &quot;id1&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;onUpdate&quot; : &quot;NO ACTION&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;onDelete&quot; : &quot;NO ACTION&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isDeferred&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;uniqueKeys&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id1_uk&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;columns&quot; : [ &quot;id1&quot; ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id4_uk&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;columns&quot; : [ &quot;id4&quot; ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;uk1&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;columns&quot; : [ &quot;id2&quot;, &quot;id3&quot; ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;uk2&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;columns&quot; : [ &quot;id3&quot;, &quot;id4&quot; ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>Foreign keys can include the full set of actions.  Here are a couple of examples:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE TABLE T11(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      id1 INTEGER,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      id2 INTEGER,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      id3 INTEGER,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      FOREIGN KEY (id1) REFERENCES T9 (id1) ON DELETE CASCADE,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      FOREIGN KEY (id1) REFERENCES T9 (id1) ON UPDATE SET NULL</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;T11&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;columns&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id1&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id2&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id3&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;primaryKey&quot; : [  ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;foreignKeys&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;columns&quot; : [ &quot;id1&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;referenceTable&quot; : &quot;T9&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;referenceColumns&quot; : [ &quot;id1&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;onUpdate&quot; : &quot;NO ACTION&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;onDelete&quot; : &quot;CASCADE&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isDeferred&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;columns&quot; : [ &quot;id1&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;referenceTable&quot; : &quot;T9&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;referenceColumns&quot; : [ &quot;id1&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;onUpdate&quot; : &quot;SET NULL&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;onDelete&quot; : &quot;NO ACTION&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isDeferred&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>Deferred FK actions can also be specified.  Note: per the SQLite documentation, the norm is immediate on everything except <code>deferrable initially deferred</code>.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE TABLE T12(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      id1 INTEGER,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      id2 INTEGER,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      id3 INTEGER,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      FOREIGN KEY (id1) REFERENCES T9 (id1) ON DELETE SET DEFAULT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       DEFERRABLE INITIALLY DEFERRED,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      FOREIGN KEY (id2) REFERENCES T9 (id1) ON UPDATE NO ACTION</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;T12&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;columns&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id1&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id2&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id3&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;foreignKeys&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;columns&quot; : [ &quot;id1&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;referenceTable&quot; : &quot;T9&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;referenceColumns&quot; : [ &quot;id1&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;onUpdate&quot; : &quot;NO ACTION&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;onDelete&quot; : &quot;SET DEFAULT&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isDeferred&quot; : 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;columns&quot; : [ &quot;id2&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;referenceTable&quot; : &quot;T9&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;referenceColumns&quot; : [ &quot;id1&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;onUpdate&quot; : &quot;NO ACTION&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;onDelete&quot; : &quot;NO ACTION&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isDeferred&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>Just like unique keys, foreign keys on the columns are moved down as though they had been independently declared.  There are 3 foreign keys below.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE TABLE with_fk_on_columns(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      id1 INTEGER NOT NULL REFERENCES T2 (id) ON UPDATE CASCADE</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        DEFERRABLE INITIALLY DEFERRED,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      id2 INTEGER NOT NULL REFERENCES T10 (id4) ON DELETE CASCADE,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      FOREIGN KEY (id1, id2) REFERENCES T10 (id3, id4)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;with_fk_on_columns&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;temp&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;ifNotExists&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;withoutRowid&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;isAdded&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;isDeleted&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;columns&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id1&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id2&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;primaryKey&quot; : [  ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;foreignKeys&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;columns&quot; : [ &quot;id1&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;referenceTable&quot; : &quot;T2&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;referenceColumns&quot; : [ &quot;id&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;onUpdate&quot; : &quot;CASCADE&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;onDelete&quot; : &quot;NO ACTION&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isDeferred&quot; : 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;columns&quot; : [ &quot;id2&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;referenceTable&quot; : &quot;T10&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;referenceColumns&quot; : [ &quot;id4&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;onUpdate&quot; : &quot;NO ACTION&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;onDelete&quot; : &quot;CASCADE&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isDeferred&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;columns&quot; : [ &quot;id1&quot;, &quot;id2&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;referenceTable&quot; : &quot;T10&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;referenceColumns&quot; : [ &quot;id3&quot;, &quot;id4&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;onUpdate&quot; : &quot;NO ACTION&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;onDelete&quot; : &quot;NO ACTION&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isDeferred&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;uniqueKeys&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div></div></div></div></div><p>Columns can be marked with <code>@sensitive</code> for privacy reasons.  This declaration flows to the column description as <code>isSensitive</code>.  For economy, <code>isSenstive</code> is only emitted when true.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE TABLE radioactive(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      id INTEGER NOT NULL,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      danger TEXT @SENSITIVE</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;radioactive&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;isTemp&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;ifNotExists&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;withoutRowid&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;isAdded&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;isDeleted&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;isRecreated&quot;: 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;columns&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isAdded&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isDeleted&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isPrimaryKey&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isUniqueKey&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isAutoIncrement&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;danger&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;text&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isSensitive&quot; : 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isAdded&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isDeleted&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isPrimaryKey&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isUniqueKey&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isAutoIncrement&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;primaryKey&quot; : [  ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;foreignKeys&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;uniqueKeys&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ],</span></div></div></div></div></div><p>The next major section is the views.  Each view includes its projection (that is the net columns it creates from the select clause) and its general statement information.  One example tells the story pretty clearly.  Views don&#x27;t have arguments in any supported cases but the arguments are included for symmetry with the other forms.  Note: projection columns can be sensitive and will be so-marked if they are.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;views&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE VIEW MyView AS</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    SELECT *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      FROM Foo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;MyView&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;temp&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;projection&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;name&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;text&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;select&quot; : &quot;SELECT id, name FROM Foo&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;selectArgs&quot; : [  ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>Likewise indices contain the table and indexed columns.  This one example illustrates things fairly clearly.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;indices&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE UNIQUE INDEX IF NOT EXISTS MyIndex ON Foo (name DESC, id ASC)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;MyIndex&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;table&quot; : &quot;Foo&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;isUnique&quot; : 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;ifNotExists&quot; : 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;columns&quot; : [ &quot;name&quot;, &quot;id&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;sortOrders&quot; : [ &quot;desc&quot;, &quot;asc&quot; ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ],</span></div></div></div></div></div><p>The top level attributes go, by convention, on a the global variable named <code>database</code> of type <code>object</code>.  These attributes move into the JSON.  Other globals are ignored.</p><p>NOTE: attributes are very flexible, allowing nesting of arrays.  Attributes values can either be any literal, or a name, or an array of values, recursively.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @ATTRIBUTE(my_other_attribute=(&#x27;any&#x27;, (&#x27;tree&#x27;, &#x27;of&#x27;), &#x27;values&#x27;))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @ATTRIBUTE(dbname=&#x27;fred.sql&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @ATTRIBUTE(dbfile=&#x27;cg_test_mlite_query.sql&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  DECLARE database OBJECT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;attributes&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;my_other_attribute&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;value&quot; : [&quot;any&quot;, [&quot;tree&quot;, &quot;of&quot;], &quot;values&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;dbname&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;value&quot; : &quot;fred.sql&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;dbfile&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;value&quot; : &quot;cg_test_mlite_query.sql&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>The queries section corresponds to the stored procedures with a SELECT statement.  There is significant data provided about each one.</p><ul><li>the name of the procedure</li><li>the number and type of arguments</li><li>the set of tables used anywhere in the query (for dependencies)<ul><li>this includes tables used within views that were used</li></ul></li><li>the query projection (aka the result shape of the select)</li><li>the full SQL statement and the arguments that should be bound to each <code>?</code></li></ul><p>There are two examples below:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;queries&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE PROC a_query (pattern TEXT NOT NULL, reject TEXT)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    BEGIN</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    SELECT id</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      FROM Foo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      WHERE name LIKE pattern AND name &lt;&gt; reject;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    END</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;a_query&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;args&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;pattern&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;text&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;reject&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;text&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;usesTables&quot; : [ &quot;Foo&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;projection&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;statement&quot; : &quot;SELECT id FROM Foo WHERE name LIKE ? AND name &lt;&gt; ?&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;statementArgs&quot; : [ &quot;pattern&quot;, &quot;reject&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE PROC bigger_query (pattern TEXT NOT NULL, reject TEXT)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    BEGIN</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    SELECT DISTINCT *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      FROM Foo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      WHERE name LIKE pattern AND name &lt;&gt; reject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      GROUP BY name</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      HAVING name &gt; reject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ORDER BY pattern</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      LIMIT 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      OFFSET 3;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    END</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;bigger_query&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;args&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;pattern&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;text&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;reject&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;text&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;usesTables&quot; : [ &quot;Foo&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;projection&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;name&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;text&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;statement&quot; : &quot;SELECT DISTINCT id, name FROM Foo WHERE name LIKE ? AND</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          name &lt;&gt; ? GROUP BY name HAVING name &gt; ? ORDER BY ?</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          LIMIT 1 OFFSET 3&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;statementArgs&quot; : [ &quot;pattern&quot;, &quot;reject&quot;, &quot;reject&quot;, &quot;pattern&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>The section on insert statements is very similar in shape.  Again the fields are:</p><ul><li>the name of the procedure</li><li>the arguments and argument types</li><li>the tables used by the insert statement (usually just the one but value expressions can be select statements so it can be more)</li><li>the table we are inserting into (certainly present in <code>usesTables</code>)</li><li>the overall statement and its arguments (easiest form to use)</li><li>the statement type (e.g. <code>INSERT</code> or <code>INSERT OR REPLACE</code>)</li><li>the inserted columns<ul><li>present even if the <code>insert into table values (...)</code> form was used</li></ul></li><li>the array of value expressions and arguments, one for each value</li></ul><p>Again, simple insert forms are readily recognized and complex forms are supported.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inserts&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    The statement ending at line 277</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE PROC insert_proc (id_ INTEGER NOT NULL, name_ TEXT)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    BEGIN</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    INSERT OR REPLACE INTO Foo (id, name) VALUES (id_, name_);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    END</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;insert_proc&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;args&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id_&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;name_&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;text&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;usesTables&quot; : [ &quot;Foo&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;table&quot; : &quot;Foo&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;statement&quot; : &quot;INSERT OR REPLACE INTO Foo (id, name) VALUES (?, ?)&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;statementArgs&quot; : [ &quot;id_&quot;, &quot;name_&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;statementType&quot; : &quot;INSERT OR REPLACE&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;columns&quot; : [ &quot;id&quot;, &quot;name&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;values&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;value&quot; : &quot;?&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;valueArgs&quot; : [ &quot;id_&quot; ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;value&quot; : &quot;?&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;valueArgs&quot; : [ &quot;name_&quot; ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>As another example, this fairly easy to write CQL transparently creates dummy values.  Great for use in testing.  The JSON shows the net insert created from the original source below.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE PROC dummy_insert_proc (seed_ INTEGER NOT NULL)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    BEGIN</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    INSERT INTO Foo () VALUES () @DUMMY_SEED(seed_) @DUMMY_NULLABLES;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    END</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;dummy_insert_proc&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;args&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;seed_&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;usesTables&quot; : [ &quot;Foo&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;table&quot; : &quot;Foo&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;statement&quot; : &quot;INSERT INTO Foo (id, name)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            VALUES (?, printf(&#x27;name_%d&#x27;, ?))&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;statementArgs&quot; : [ &quot;_seed_&quot;, &quot;_seed_&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;statementType&quot; : &quot;INSERT&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;columns&quot; : [ &quot;id&quot;, &quot;name&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;values&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;value&quot; : &quot;?&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;valueArgs&quot; : [ &quot;_seed_&quot; ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;value&quot; : &quot;printf(&#x27;name_%d&#x27;, ?)&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;valueArgs&quot; : [ &quot;_seed_&quot; ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>The above form can capture the simplest of the insert statements allowed in SQLite.  This is especially
interesting because the JSON above can cleanly capture each value and the only place where there might be
references to the procedure arguments is in the <code>valueArgs</code> portion. There is simply no room for any other
kind of variability.   As a result, it&#x27;s actually possible to take this type of insert and potentially
re-codegen it into an upsert or something else starting from the JSON.  This is isn&#x27;t in general possible
with the other forms of insert.  More compilicated forms of insert go into a section called &quot;generalInesrts&quot;
this includes any other single insert statement such as these forms:</p><ul><li>insert from multiple value rows</li><li>insert from a select statement</li><li>insert using a <code>WITH</code> clause</li><li>insert using the upsert clause</li></ul><p>The &quot;generalInserts&quot; section looks exactly like the &quot;inserts&quot; section except that it does not include &quot;values&quot;.</p><p>Here&#x27;s an example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;generalInserts&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   CREATE PROC insert_compound ()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    BEGIN</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    INSERT INTO T3(id) VALUES(1)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    UNION ALL</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    SELECT 1 AS column1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    END</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;insert_compound&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;definedInFile&quot; : &quot;cg_test_json_schema.sql&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;args&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;insertTables&quot; : [ &quot;T3&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;usesTables&quot; : [ &quot;T3&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;table&quot; : &quot;T3&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;statement&quot; : &quot;INSERT INTO T3(id) VALUES(1) UNION ALL SELECT 1 AS column1&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;statementArgs&quot; : [  ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;statementType&quot; : &quot;INSERT&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;columns&quot; : [ &quot;id&quot; ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ],</span></div></div></div></div></div><p>Update statements are handled very much like the others, but there are no statement fragments.  You get these pieces:</p><ul><li>the name of the procedure and its arguments</li><li>dependency information</li><li>the statement text and its arguments</li></ul><p>This is the minimum information needed to bind and run the statement.  Note that arguments can be in any part of the update.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;updates&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    The statement ending at line 306</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE PROC update_proc (id_ INTEGER NOT NULL, name_ TEXT)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    BEGIN</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    UPDATE Foo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    SET name = name_</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      WHERE id = id_</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ORDER BY name</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      LIMIT 1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    END</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;update_proc&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;args&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;id_&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;name_&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;text&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;usesTables&quot; : [ &quot;Foo&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;table&quot; : &quot;Foo&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;statement&quot; : &quot;UPDATE Foo SET name = ?</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              WHERE id = ? ORDER BY name LIMIT 1&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;statementArgs&quot; : [ &quot;name_&quot;, &quot;id_&quot; ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>The delete section looks exactly like the update section.</p><ul><li>procedure name and arguments</li><li>dependency information</li><li>statement and arguments</li></ul><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;deletes&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    The statement ending at line 297</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE PROC delete_proc (name_ TEXT)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    BEGIN</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    DELETE FROM Foo WHERE name LIKE name_;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    END</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;delete_proc&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;args&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;name_&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;text&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;usesTables&quot; : [ &quot;Foo&quot; ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;table&quot; : &quot;Foo&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;statement&quot; : &quot;DELETE FROM Foo WHERE name LIKE ?&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;statementArgs&quot; : [ &quot;name_&quot; ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>And finally the section for procedures that were encountered that are not one of the simple prepared statement forms.  The principle reasons for being in this category are:</p><ul><li>the procedure has out arguments</li><li>the procedure uses something other than a single DML statement</li><li>the procedure has no projection (no result of any type)</li></ul><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;general&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE PROC with_complex_args (OUT pattern TEXT NOT NULL, INOUT arg REAL)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    BEGIN</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      SELECT 1 AS a;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    END</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;with_complex_args&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;args&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;pattern&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;text&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;binding&quot; : &quot;out&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;arg&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;real&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 0,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;binding&quot; : &quot;inout&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;usesTables&quot; : [  ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;hasSelectResult&quot; : 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;projection&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;a&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;usesDatabase&quot; : 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE PROC atypical_noreturn ()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    BEGIN</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      DECLARE C CURSOR LIKE SELECT 1 AS A;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    END</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;atypical_noreturn&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;args&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;usesTables&quot; : [  ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;usesDatabase&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CREATE PROC typical_outresult ()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    BEGIN</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      DECLARE C CURSOR LIKE SELECT 1 AS A;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      FETCH C (A) FROM VALUES (7);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      OUT C;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    END</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot; : &quot;typical_outresult&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;args&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;usesTables&quot; : [  ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;hasOutResult&quot; : 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;projection&quot; : [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot; : &quot;A&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot; : &quot;integer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;isNotNull&quot; : 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;usesDatabase&quot; : 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>Some additional properties not mentioned above that are worth noting:</p><ul><li>where <code>usesTables</code> appears there will also be more detailed information about how the tables were used<ul><li>the <code>usesViews</code> key will give you an array of the views that were used (these lead to more views/tables also included)</li><li>the <code>insertTables</code> key will give you an array of the tables that were used as the target of an <code>insert</code> statement</li><li>the <code>updateTables</code> key will give you an array of the tables that were used as the target of an <code>update</code> statement</li><li>the <code>deleteTables</code> key will give you an array of the tables that were used as the target of an <code>delete</code> statement</li><li>the <code>fromTables</code> key will give you an array of tables that were used the the <code>from</code> clause of a select or some other <code>select</code>-ish context in which you only read from the table</li></ul></li><li>the <code>usesProcedures</code> key for a given proc has an array of the procedures it calls, this allows for complete dependency analysis if needed</li></ul><p>To use cql in this fashion:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cql --in input.sql --rt json_schema --cg out.json</span></div></div></div></div></div><p>NOTE: <code>@ATTRIBUTE</code> can be applied any number of times to the entities here, including the procedures (i.e. immediately before the <code>CREATE PROCEDURE</code>) .  Those attributes appear in the JSON in an optional <code>attributes</code> chunk.  Attributes are quite flexible (you can easily encode a lisp program in attributes if you were so inclined) so you can use them very effectively to annotate your CQL entities as needed for downstream tools.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"></div><div class="col text--right"><em><small>Last updated on <time datetime="2021-07-01T12:24:29.000Z" class="docLastUpdatedAt_217_">7/1/2021</time> by <strong>mingodad</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/cql-guide/ch12"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Chapter 12: Testability Features</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/cql-guide/ch14"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Chapter 14: CQL Query Fragments Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Learn</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction">Getting Started</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.youtube.com/channel/UC2lTapw2Um90sZpGQVaynEg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube</a></li><li class="footer__item"><a href="https://twitter.com/fbOpenSource" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebookincubator/CG-SQL" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_1zJy"><img class="footer__logo" alt="Facebook Open Source Logo" src="/img/oss_logo.png"></a></div><div>Copyright Â© 2021 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.480d1f30.js"></script>
<script src="/runtime~main.34082030.js"></script>
<script src="/main.b815b31d.js"></script>
<script src="/1.2e95473d.js"></script>
<script src="/2.0c45b020.js"></script>
<script src="/3.d04889a6.js"></script>
<script src="/1be78505.d00e88e1.js"></script>
<script src="/82.ac17f5fe.js"></script>
<script src="/5456faf3.a2899e62.js"></script>
<script src="/17896441.ea9e5e3f.js"></script>
<script src="/c161a506.5d6875a9.js"></script>
</body>
</html>